function pot = potential0
pot.Singlea = @Singlea;
pot.Singleb = @Singleb;
pot.Paira = @Paira;
pot.Pairb = @Pairb;
pot.Pairc = @Pairc;
pot.Tripleta = @Tripleta;
pot.Tripletb = @Tripletb;
pot.Tripletc = @Tripletc;
pot.Quadrupleta = @Quadrupleta;
pot.Quadrupletb = @Quadrupletb;
end

% one-body non-bonded potentials 
function u = Singlea(xi, qi, ti, mu, eta, kappa)
    u = 0.0;    
end

% one-body bonded potentials 
function u = Singleb(xi, qi, ti, mu, eta, kappa)
    u = 0.0;    
end

% two-body non-bonded potentials 
function u = Paira(xij, qi, qj, ti, tj, mu, eta, kappa)
    u = 0.0;    
end

% two-body bonded potentials 
function u = Pairb(xij, qi, qj, ti, tj, mu, eta, kappa)
    u = 0.0;    
end

% two-body bond order potentials (EAM-like potentials)
function u = Pairc(xij, qi, qj, ti, tj, rho, mu, eta, kappa)
    u = 0.0;
    r2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    r = sqrt(r2);
    
    % EAM Potential 
    a1 = mu(1);
    m1 = mu(2);    
    a2 = mu(3);
    m2 = mu(4);    
    rhoaa = (a1/r)^m1;
    rhoab = (a2/r)^m2;
    Fa = -sqrt(rho(1));        
    ua = [rhoaa; rhoab; Fa];
    
    u = [ua ua];
end

% three-body non-bonded potentials 
function u = Tripleta(xij, xik, qi, qj, qk, ti, tj, tk, mu, eta, kappa)
    u = 0.0;         
end

% three-body bonded potentials 
function u = Tripletb(xij, xik, qi, qj, qk, ti, tj, tk, mu, eta, kappa)
    %u = 0.0;    
        
    xdot = xij(1)*xik(1) + xij(2)*xik(2) + xij(3)*xik(3);
    rij2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    rik2 = xik(1)*xik(1) + xik(2)*xik(2) + xik(3)*xik(3);    
    rij = sqrt(rij2);  % distance between atom i and atom j  
    rik = sqrt(rik2);  % distance between atom i and atom k
    
    % cos(theta), where theta is the angle between xij and xik
    costhe = xdot/(rij*rik);
        
    rjk2 = rij2 + rik2 - 2*rij*rik*costhe;
    rjk = sqrt(rjk2); % distance between atom j and atom k
    
    u1 = mu(1)*(costhe - mu(2))^2;   
    u2 = u1 + mu(3)*(mu(4) - rjk)^2;
    u = [u1 u2];
end

% three-body bond porder potentials (Terssof-like potentials)
function u = Tripletc(xij, xik, qi, qj, qk, ti, tj, tk, rho, mu, eta, kappa)
    %u = 0.0;
    
    xdot = xij(1)*xik(1) + xij(2)*xik(2) + xij(3)*xik(3);
    rij2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    rik2 = xik(1)*xik(1) + xik(2)*xik(2) + xik(3)*xik(3);    
    rij = sqrt(rij2);  % distance between atom i and atom j  
    rik = sqrt(rik2);  % distance between atom i and atom k
    
    % cos(theta), where theta is the angle between xij and xik
    costhe = xdot/(rij*rik);
   
    B = mu(1);
    lambda2 = mu(2);
    lambda3 = mu(3);
    gamma = mu(4);
    c = mu(5);
    d = mu(6);
    cos0 = mu(7);
    m = mu(8);
    n = mu(9);
    beta = mu(10);
    
    fA = -B*exp(-lambda2*rij);
    fB = gamma*(1 + c^2/d^2 - c^2/(d^2 + (costhe-cos0)^2))*exp(lambda3^m*(rij - rik)^m);
    fC = gamma*(1 + c^2/d^2 - c^2/(d^2 + (costhe-cos0)^2))*exp(lambda3^m*(rij - rik)^m);
    fD = (1 + beta^n*rho(1)^n)^(-1.0/(2*n));
    u = [fA; fB; fC; fD]; 
end

% four-body non-bonded potentials
function u = Quadrupleta(xij, xik, xil, qi, qj, qk, ql, ti, tj, tk, tl, mu, eta, kappa)
    u = 0.0;    
end

% four-body bonded potentials 
function u = Quadrupletb(xij, xik, xil, qi, qj, qk, ql, ti, tj, tk, tl, mu, eta, kappa)
    %u = 0.0;    
    
    % calculate the distance d from atom i to a plane defined by 3 atoms (j, k, l)
    xjk = xik - xij;
    xjl = xil - xij;
    n1 = xjk(2)*xjl(3) - xjk(3)*xjl(2);
    n2 = xjk(3)*xjl(1) - xjk(1)*xjl(3);
    n3 = xjk(1)*xjl(2) - xjk(2)*xjl(1);
    nn = sqrt(n1*n1 + n2*n2 + n3*n3);
    d = (n1*xij(1) + n2*xij(2) + n3*xij(3))/nn;    
    
    u = mu(1)*d^2 + mu(2)*d^4;
end

