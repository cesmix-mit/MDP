function pot = potential
pot.Singlea = @Singlea;
pot.Singleb = @Singleb;
pot.Paira = @Paira;
pot.Pairb = @Pairb;
pot.Pairc = @Pairc;
pot.Tripleta = @Tripleta;
pot.Tripletb = @Tripletb;
pot.Tripletc = @Tripletc;
pot.Quadrupleta = @Quadrupleta;
pot.Quadrupletb = @Quadrupletb;
end

% one-body non-bonded potentials 
function u = Singlea(xi, qi, ti, mu, eta, kappa)
    u = 0.0;    
end

% one-body bonded potentials 
function u = Singleb(xi, qi, ti, mu, eta, kappa)
    u = 0.0;    
end

% two-body non-bonded potentials 
function u = Paira(xij, qi, qj, ti, tj, mu, eta, kappa)
    %u = 0.0;    
%     dim = kappa(1); % physical dimension
%     nat = kappa(2); % number of atom types
    
    r2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    r = sqrt(r2);
    r3 = r2*r;
    r4 = r2*r2;
    r5 = r4*r;
    r6 = r2*r4;
    r7 = r6*r;
    r12 = r6*r6;
    
    % shitfted Lennard-Jones potential   
    R = eta(1);     % cut-off radius for shitfted Lennard-Jones potential   
    R2 = R*R;
    R4 = R2*R2;
    R6 = R4*R2;
    R12 = R6*R6;
    A = mu(1);
    B = mu(2);
    uLJ = (A/r12 - B/r6) - (A/R12 - B/R6);    
    
    % shielded Coulomb potential (cf. ReaxFF)
    Rcut = eta(2); % cut-off radius for Coulomb potential   
    tap0 = 1; 
    tap4 = -35/(Rcut^4);
    tap5 = 84/(Rcut^5);
    tap6 = -70/(Rcut^6);
    tap7 = 20/(Rcut^7);
    tap = tap0 + tap4*r4 + tap5*r5 + tap6*r6 + tap7*r7;
    gamma = mu(3);
    C  = mu(4);
    rs = (r3 + (1/gamma)^3)^(1/3);
    uC = tap*C*qi(1)*qj(1)/rs; 
    
    % shielded Morse potential (cf. ReaxFF)
    Rcut = eta(3); % cut-off radius for shielded Morse potential   
    tap0 = 1; 
    tap4 = -35/(Rcut^4);
    tap5 = 84/(Rcut^5);
    tap6 = -70/(Rcut^6);
    tap7 = 20/(Rcut^7);
    tap = tap0 + tap4*r4 + tap5*r5 + tap6*r6 + tap7*r7;
    gamma = mu(5);
    D  = mu(6);
    a  = mu(7);
    re  = mu(8);    
    p = mu(9);
    rs = (r^p + (1/gamma)^p)^(1.0/p);
    tm = a*(1 - rs/re);
    uM = tap*D*(exp(tm) - 2*exp(0.5*tm)); 
    
    u = [uLJ uC uM];
end

% two-body bonded potentials 
function u = Pairb(xij, qi, qj, ti, tj, mu, eta, kappa)
    %u = 0.0;    
    r2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    r = sqrt(r2);
    
    % bonded Morse potential 
    D  = mu(1);
    a  = mu(2);
    rc = mu(3);            
    tm = 2*a*(rc - r);
    uM = D*(exp(tm) - 2*exp(tm));     
    
    % bonded harmonic potential 
    K  = mu(4);
    r0  = mu(5);
    rc  = mu(6);                
    uH = K*((r-r0)^2 - (rc-r0)^2);
    
    u = [uM uH];
end

% two-body bond order potentials (EAM-like potentials)
function u = Pairc(xij, qi, qj, ti, tj, rho, mu, eta, kappa)
    %u = 0.0;
    r2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    r = sqrt(r2);
    
    % EAM Potential 
    a1 = mu(1);
    m1 = mu(2);    
    a2 = mu(3);
    m2 = mu(4);    
    rhoaa = (a1/r)^m1;
    rhoab = (a2/r)^m2;
    Fa = -sqrt(rho);        
    ua = [rhoaa; rhoab; Fa];
    
    u = [ua ua];
end

% three-body non-bonded potentials 
function u = Tripleta(xij, xik, qi, qj, qk, ti, tj, tk, mu, eta, kappa)
    u = 0.0;         
end

% three-body bonded potentials 
function u = Tripletb(xij, xik, qi, qj, qk, ti, tj, tk, mu, eta, kappa)
    %u = 0.0;    
        
    xdot = xij(1)*xik(1) + xij(2)*xik(2) + xij(3)*xik(3);
    rij2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    rik2 = xik(1)*xik(1) + xik(2)*xik(2) + xik(3)*xik(3);    
    rij = sqrt(rij2);  % distance between atom i and atom j  
    rik = sqrt(rik2);  % distance between atom i and atom k
    
    % cos(theta), where theta is the angle between xij and xik
    costhe = xdot/(rij*rik);
        
    rjk2 = rij2 + rik2 - 2*rij*rik*costhe;
    rjk = sqrt(rjk2); % distance between atom j and atom k
    
    u1 = mu(1)*(costhe - mu(2))^2;   
    u2 = u1 + mu(3)*(mu(4) - rjk)^2;
    u = [u1 u2];
end

% three-body bond porder potentials (Terssof-like potentials)
function u = Tripletc(xij, xik, qi, qj, qk, ti, tj, tk, rho, mu, eta, kappa)
    %u = 0.0;
    
    xdot = xij(1)*xik(1) + xij(2)*xik(2) + xij(3)*xik(3);
    rij2 = xij(1)*xij(1) + xij(2)*xij(2) + xij(3)*xij(3);    
    rik2 = xik(1)*xik(1) + xik(2)*xik(2) + xik(3)*xik(3);    
    rij = sqrt(rij2);  % distance between atom i and atom j  
    rik = sqrt(rik2);  % distance between atom i and atom k
    
    % cos(theta), where theta is the angle between xij and xik
    costhe = xdot/(rij*rik);
   
    -B*
    rhoaa = gamma*(1 + c^2/d^2 - c^2/(d^2 + (costhe-cos0)^2))*exp(lambda3^m*(rij - rik)^m);
    rhoab = gamma*(1 + c^2/d^2 - c^2/(d^2 + (costhe-cos0)^2))*exp(lambda3^m*(rij - rik)^m);
    F = (1 + beta^n*rho^n)^(-1.0/(2*n));
    
end

% four-body non-bonded potentials
function u = Quadrupleta(xij, xik, xil, qi, qj, qk, ql, ti, tj, tk, tl, mu, eta, kappa)
    u = 0.0;    
end

% four-body bonded potentials 
function u = Quadrupletb(xij, xik, xil, qi, qj, qk, ql, ti, tj, tk, tl, mu, eta, kappa)
    u = 0.0;    
end

